#!/bin/sh
#
# Install Python modules in the python-packages.txt requirements file.

set -u

python=$(which python)
if [ -z "${python}" -o ! -x "${python}" ]; then
    echo "error: Python not installed, not installing Python packages."
    exit 1
fi

pip="$(python -c 'import site ; print site.USER_BASE')/bin/pip"
if [ -z "${pip}" -o ! -x "${pip}" ]; then
    wget https://bootstrap.pypa.io/get-pip.py
    if [ ! -e get-pip.py ]; then
        echo "warning: pip failed to install, not installing Python packages."
        exit 1
    fi

    ${python} get-pip.py --user
    rm get-pip.py
fi

if [ -z "${pip}" -o ! -x "${pip}" ]; then
    echo "error: pip not installing, not installing Python packages."
    exit 1
fi

${pip} install --user --upgrade -r python-packages.txt
