#!/usr/bin/env python
#
# Install Go packages.

import sys
import os
import subprocess
import distutils.spawn


def emulate_run(s):
    if subprocess.call(s, shell=True) == 0:
        return True
    return False

HOME = os.environ["HOME"]

go = distutils.spawn.find_executable("go")
if not go:
    print "error: Go not installed, not installing Go packages."
    sys.exit(1)

with open("go-packages.txt", "r") as f:
    for line in f:
        if line != "" and line[0] != "#":
            emulate_run("GOPATH=\"" + os.path.join(HOME, "opt", "local", "src", "go") + "\"" + go + "\" get -u \"" + line + "\"")
